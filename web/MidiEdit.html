<html>
<script src="../js/jquery.js"></script>
<link rel="stylesheet" type="text/css" href="../css/MidiEdit.css">
<link rel="SHORTCUT ICON" href='../resources/home.png'>
<script src="../github/JZZ-master/javascript/JZZ.js"></script>
<script src="../github/JZZ-midi-SMF-master/javascript/JZZ.midi.SMF.js"></script>
<script src="../github/JZZ-synth-Tiny-master/javascript/JZZ.synth.Tiny.js"></script>
<script src="../js/bar.js"></script>
<script src="../js/receiver.js"></script>
<head>
  <meta charset="UTF-8" >
</head>
<body onload="createTable()">
  <div style=" width: 98%;color:white; position:absolute; top:5%; margin-top:-10px;" id=tools>
    &nbsp;&nbsp;&nbsp;
    速度:<input class="tool-btn" type="text" name="BPM_val" style="width:50px;" value="50">bpm
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <input class="tool-btn" id="btn" type="button" value="播放" onclick="fromBase64()">
    <input class="tool-btn" id="btn2" type="button" value="暫停" onclick="playPause()">
    <input class="tool-btn" id="btn3" type="button" value="停止" onclick="playStop()">
    <input class="tool-btn" id="btn4" type="button" value="清除全部" >
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    音色:   
    <select id='tone' value='音色切換' onchange="changeTone()">
      <option value="0">Acousitc Piano</option>
      <option value="1">Bright Piano</option>
      <option value="2">Electric Grand Piano</option>
      <option value="3">Honky-tonk Piano</option>
      <option value="4">Electric Piano 1</option>
      <option value="5">Electric Piano 2</option>
      <option value="6">Harpsichord</option>
      <option value="7">Clavintet</option>
      <option value="8">Celesta</option>
      <option value="9">Glockensipel</option>
      <option value="10">Music Box</option>
      <option value="11">Vibraphone</option>
      <option value="12">Marimba</option>
      <option value="13">Xylophone</option>
      <option value="14 ">Tubular Bells</option>
      <option value="15">Dulcimer</option>
      <option value="16">Organ</option>
      <option value="19">Church Organ</option>
      <option value="22">Harmonica</option>
      <option value="25">Acoustic guitar </option>
      <option value="30">Electric guitar</option>
      <option value="32">Bass</option>
      <option value="40">Violin</option>
      <option value="64">Sax</option>
      <option value="73">FLute</option>
      <option value="74">Recoder</option>
      <option value="108">Kalimba</option>
      <option value="112">Tinkle Bell</option>
      <option value="115">Wood Block</option>
    </select>

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    功能選取:
    <select id='select' value='選取功能' onchange="mouseToChoose()">
      <option value='編輯'>編輯音符</option>
      <option value='選取'>選取範圍</option>
    </select>

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    音量控制:
    <input style="height: 10px;" type="range"id="velocity" min="1" max = "120" >

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    匯入:
    <input id="file" type="file" size="80" onchange="importMidi()">
    <input class="tool-btn" id="export" type="button" value="匯出" disabled onclick="exportMidi()">
  </div>
  <div style="overflow-x:hidden;overflow-y:auto;position:fixed; height:84%;top:7%;">
    <table style="width:100%">
      <div></div>
      <td style="width: 148px; z-index: 2;" id="leftnotebar">
        <table class="notec" style=" position:relative; width:100%;"id="mynote">
        </table>
      </td>
      <td style="position:relative; attachment:fixed;">
        <div  style="overflow-y:hidden;width:100%;">
          <table class="notec" style=" width:100%;height: 100%;" id="mytable">
            <div id="playHead"></div>
          </table>
        </div>
      </td>
    </table>
  </div>
  <!-- <div  style="text-align:center;color:white;height:3%;width:20%;left:40%;position:absolute;top:40%; border: 1px solid white;background-Color:black;">
    <a id='progessbar'> </a>
  </div> -->
</body>
<script>

// function worker_function()
// {
//   "use strict";
// // self.importScripts('../js/jquery.js');
// self.addEventListener('message', function(e) {
//   console.log(e.data);
// }, false);
// var iii = 0;
//
//  setInterval(function(){iii = iii + 1;self.postMessage(iii + " / 54");},100);
// }

// var worker = new Worker(URL.createObjectURL(new Blob(["("+worker_function.toString()+")()"])));
let worker = null;
document.addEventListener("DOMContentLoaded", function()
{
var worker = new Worker('../js/worker.js');
worker.onmessage = (e => ViaReceiver.OnMessage(e.data));
ViaReceiver.postMessage = (data => worker.postMessage(data));
worker.postMessage("start");
});
// worker.addEventListener('DOMContentLoaded','worker_function',false);

</script>
<script src="../js/MidiEdit.js"></script>
</html>
